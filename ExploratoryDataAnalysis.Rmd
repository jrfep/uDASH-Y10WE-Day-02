---
title: "Exploratory Data Analysis"
subtitle: "uDASH Year 10 Work Experience Program: Day 2"
author: "Boris Beranger"
date: "`r format(Sys.time(), '%B, %Y')`"
output: 
  beamer_presentation:
    keep_tex: FALSE
urlcolor: blue
theme: "metropolis" 

classoption: "aspectratio=169"
institute: \includegraphics[height=2.4cm]{Udash logo CMYK revised-02.jpg}  \hskip 4cm \includegraphics[height=2.4cm]{Maths&Stats_logo.jpg}
header-includes:
- \AtBeginSection[]{\begin{frame}\tableofcontents[currentsection]\end{frame}}
- \usepackage{amsmath,bm,color}
- \hypersetup{colorlinks,citecolor=orange,filecolor=red,linkcolor=mDarkTeal,urlcolor=blue}
- \metroset{block=fill}
- \newcommand{\var}{\mbox{var}}
- \newcommand{\Var}{\mbox{Var}}
- \newcommand{\E}{\mbox{E}}
- \newcommand{\Bias}{\mbox{Bias}}
- \newcommand{\MSE}{\mbox{MSE}}
- \newcommand{\real}{\mathbb{R}}
- \newcommand{\R}{\texttt{R}}
- \newcommand{\RSt}{\texttt{RStudio}}
- \setbeamertemplate{footline}{\hfill\insertframenumber/\inserttotalframenumber\hspace{2mm}\vspace{2mm}~}
- \newcounter{numberoframes}
- \setcounter{numberoframes}{\inserttotalframenumber}
- \let\oldv\verbatim
- \let\oldendv\endverbatim
- \def\verbatim{\par\setbox0\vbox\bgroup\oldv}
- \def\endverbatim{\oldendv\egroup\fboxsep0pt \noindent\colorbox[gray]{0.95}{\usebox0}\par}
- \definecolor{shadecolor}{RGB}{211,239,255}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
```

# Introduction

## The steps involved in a Statistical Analysis

\begin{itemize}
\item \textcolor{blue}{What data to collect?} This depends on what the research question is and who asks it.
\item \textcolor{blue}{How to collect data in a clever way?} Design of experiments, computer simulations.
\item \textcolor{blue}{How to organize your data?} In paper notebooks? files? data bases?
\item \textcolor{blue}{How to describe your data?} File format and size. File content. Statistical descriptive summaries.
\item \textcolor{blue}{How to analyse data?} Relationships, statistical inference
\end{itemize}

## Data sets (I)

A \textcolor{magenta}{data set} (or dataset) is a collection of data (i.e., numbers, qualifiers, pieces of information).

In Statistics, data sets usually come from actual \textcolor{magenta}{observations} collected on \textcolor{magenta}{cases}, obtained by sampling a \textcolor{magenta}{population} (of such cases).

Most commonly, a data set corresponds to the contents of a single database table, or a single statistical \textcolor{magenta}{rectangular table}. Each row in the table corresponds to the observations (values) of a few \textcolor{magenta}{variables} (such as height and weight) on one given element (case) of that population. Each column of the table represents a particular variable.

The data set may comprise data for one or more members, corresponding to the number of rows, and called the \textcolor{magenta}{sample size}.

## Data sets (II): Words you need to know

You should \textcolor{magenta}{always} clearly identify the:

\begin{itemize}
\item \textcolor{blue}{Population}: the collection of all individuals or items or objects under consideration in a statistical study, usually determined by what we want to know.
\item \textcolor{blue}{Cases}: the members, objects, units, subjects or individuals from the population, from which information (i.e., data) is collected.
\item \textcolor{blue}{IDs}: the identification code of each case.
\item \textcolor{blue}{Sample}: a subset of the population.
\item \textcolor{blue}{Sample size}, $n$: number of cases/observations in the sample.
\item \textcolor{blue}{Variable}: a characteristic of the cases (measured, collected, recorded or counted).
\item \textcolor{blue}{Number of variables}, $p$: the total number of variable. 
\end{itemize}

## Example - A real Data Set

\begin{example}
The Tasmanian devil is a carnivorous marsupial. It was once native to mainland Australia and is now found in the wild only on the island state of Tasmania. This disappearance is usually blamed on dingoes, which are absent from Tasmania. Since the late 1990s, the devil facial tumour disease (DFTD) has drastically reduced the devil population and now threatens the survival of the species, which in 2008 was declared to be endangered.
\end{example}

\begin{center}
\includegraphics[width=0.4\textwidth]{tasmanianD2.jpg}
\includegraphics[width=0.43\textwidth]{tasmanianD.jpg}
\end{center}

## Example - A real Data Set (II)

\begin{example}
A researcher decides to conduct a study about the \textcolor{blue}{population} of Tasmanian devils (\textcolor{blue}{cases}) living in Tasmania.
She manages to capture 30 specimens in the wild (\textcolor{blue}{sample}), and for each one (Specimen 1, Specimen 2, . . . , etc.) (\textcolor{blue}{IDs/labels}) she records the following \textcolor{blue}{variables}:
\begin{itemize}
\item weight,
\item presence or absence of the disease,
\item severity of the disease on a scale of 1 (mild) to 5 (extremely severe), and
\item location where the animal was captured.
\end{itemize}

The \textcolor{blue}{sample size is $n = 30$} and the number of variables is \textcolor{blue}{$p = 4$}.

\end{example}

# Random Variables

## Quantitative or Categorical?

\begin{definition}
The \textcolor{blue}{type of a variable} is either \textcolor{magenta}{categorical} or \textcolor{magenta}{quantitative}.
\begin{itemize}
\item A \textcolor{magenta}{qualitative} or \textcolor{magenta}{categorical} variable places an individual into one of several categories.
\item A \textcolor{magenta}{quantitative} variable takes numerical values, for which arithmetic operations such as averaging make sense.
\end{itemize}
\end{definition}

\begin{example}
The variable {\bf temperature} is a ........... variable, whereas the variable {\bf sex} (assigned at birth) is a ........... variable.
\end{example}

\textcolor{magenta}{\bf Note:} for a quantitative variable, it is important to give the units of
measurements when relevant. For example, the units of temperature could be ...........

## Categorical random variables

\begin{example}
Here is a list of values that might be represented in a categorical variable:

\begin{itemize}
\item The roll of a six-sided die: possible outcomes are 1,2,3,4,5, or 6.
\item Demographic information of a population: gender, disease status.
\item The blood type of a person: A, B, AB or O.
\item The political party that a voter might vote for, e.g. Green Party, Christian Democrat, Social Democrat, etc.
\item The type of a rock: igneous, sedimentary or metamorphic.
\item The identity of a particular word (e.g., in a language model): One of V possible choices, for a vocabulary of size V.
\end{itemize}
\end{example}

## Quantitative random variables

We dissociate \textcolor{blue}{two} types of quantitative random variables:
\begin{itemize}
\item \textcolor{magenta}{Discrete random variables}: can take only distinct, separate values.

\begin{example}
\begin{itemize}
\item Monthly production of cars
\item Number of stars in the universe
\item number of heads when flipping three coins
\end{itemize}
\end{example}

\item \textcolor{magenta}{Continuous random variables}: can take any values in some interval (low, high).

\begin{example}
\begin{itemize}
\item Height of students in a class
\item Volume of petrol sold in a specific period of time
\item Commute time
\end{itemize}
\end{example}

\end{itemize}

## Exercise

\begin{block}{Exercise}
How can we help wood surfaces resist weathering, when restoring historic wooden buildings? In a study of this question, wooden panels were prepared and then exposed to the weather. Here are some of the variables recorded:
\begin{enumerate}
\item Type of wood (yellow poplar, pine, cedar)
\item Water repellent (solvent-based, water-based)
\item Paint thickness (millimetres)
\item Paint colour (white, grey, light blue)
\item Weathering time (months)
\end{enumerate}

Which of these variables are categorical, and which are quantitative?

\end{block}

## Exercise

\begin{block}{Exercise}
How can we help wood surfaces resist weathering, when restoring historic wooden buildings? In a study of this question, wooden panels were prepared and then exposed to the weather. Here are some of the variables recorded:
\begin{enumerate}
\item Type of wood (yellow poplar, pine, cedar) \textcolor{magenta}{categorical}
\item Water repellent (solvent-based, water-based) \textcolor{magenta}{categorical}
\item Paint thickness (millimetres) \textcolor{magenta}{quantitative}
\item Paint colour (white, grey, light blue) \textcolor{magenta}{categorical}
\item Weathering time (months) \textcolor{magenta}{quantitative}
\end{enumerate}

\end{block}

# Numerical summaries for one variables

## Numerical summaries for a categorical variable

We can summarise one categorical variable using \textcolor{magenta}{table of frequencies} which corresponds to

\begin{itemize}
\item list of the possible categories (even those not observed);
\item together with their counts, percent or proportion of cases in each category.
\end{itemize}

## Numerical summaries for a categorical variable (II)

\begin{example}
Consider the MATH1041 Class Survey data, and the survey question “Did you watch the Australian Open Women Tennis Final (yes/no)?”.
Produce an appropriate numerical summary for this variable.
\end{example}

```{r echo=TRUE, message=FALSE}
load("MATH1041-2024T1.RData")
table(tennis.tv)
```

## Numerical summaries for a categorical variable (III)

```{r echo=TRUE, message=FALSE}
prop.table(table(tennis.tv)) * 100
```

```{r echo=TRUE, message=FALSE}
tbl <- table(tennis.tv)
cbind(tbl, prop.table(tbl) * 100)
```

## Numerical summaries for quantitative random variables

\textcolor{magenta}{Is it a good idea to compute a table of frequencies or percentages for a quantitative variable? Why? Why not?}

\pause

\textcolor{blue}{Try to describe / summarise / compare these two different data sets. (Pay attention to the x-axis values.)}

\includegraphics[width=0.9\textwidth]{quantitative.png}

\pause

When summarising a **quantitative** variable numerically, we often make sure to include measures of:
\begin{itemize}
\item the \textcolor{magenta}{location} (where most of the data are), and 
\item the \textcolor{magenta}{spread} (or variability) of the data.
\end{itemize}

## Numerical summaries for quantitative random variables (II)

\underline{A useful measure for location could be the \textcolor{magenta}{mean}}. Mathematically, let $\boldsymbol{x}= \{ x_1, \ldots, x_n \}$ represent the $n$ observations (the data points), the mean is calculated as:
$$ \textrm{mean}(\boldsymbol{x})  = \frac{x_1 + \cdots + x_n}{n}.$$
An alternative to the mean is the \textcolor{magenta}{median}, it corresponds to the ``middle value``. If we sort the observations into $x_{(1)} \leq \cdots \leq x_{(n)}$, the median is computed as
$$\textrm{median}(\boldsymbol{x}) = x_{(n+1)/2}  \textrm{ if } n \textrm{ is odd} \quad \textrm{and} \quad 
\textrm{median}(\boldsymbol{x}) = \frac{1}{2}\left( x_{n/2} + x_{(n+1)/2}\right) \textrm{ if } n \textrm{ is even.}$$

\textcolor{magenta}{WARNING} *The mean can be grossly affected by unusually large (or small) data values that tend to be quite far away from the bulk of the data.*

```{r echo=TRUE, message=FALSE}
c(mean(unsw.satisfaction), median(unsw.satisfaction))
```

## Numerical summaries for quantitative random variables (III)

The median splits the data into two groups which contain roughly $50\%$ of the data.

\textcolor{magenta}{Quartiles} divide the data into four groups which each contain roughly $25\%$ (a quarter) of the data. \textcolor{blue}{$Q_1$} and \textcolor{blue}{$Q_3$} are known as the \textcolor{blue}{first} and \textcolor{blue}{third} quantile. \textcolor{blue}{$Q_2$} is just the median.

\begin{center}
\includegraphics[width=0.45\textwidth]{Quartiles.png}
\end{center}

```{r echo=TRUE, message=FALSE}
quantile(unsw.satisfaction, c(0.25, 0.75))
```

## Numerical summaries for quantitative random variables (IV)

\underline{A useful measure for spread could be the \textcolor{magenta}{inter-quantile range (IQR)}}.

\begin{center}
\includegraphics[width=0.45\textwidth]{IQR.png}
\end{center}

Other useful measures are the \textcolor{magenta}{standard deviation} $\textrm{sd}(\boldsymbol{x})$ and the \textcolor{magenta}{variance} $\textrm{var}(\boldsymbol{x}) = \textrm{sd}(\boldsymbol{x})^2$

We voluntarily omit the mathematical expressions, we will use \texttt{R} to calculate them directly.

## Numerical summaries for quantitative random variables (V)

In \texttt{R}, the IQR, mean and variance are obtain by running

```{r echo=TRUE, message=FALSE}
diff(quantile(unsw.satisfaction, c(0.25, 0.75)))
c( sd(unsw.satisfaction), sd(unsw.satisfaction)^2, var(unsw.satisfaction))
```

Another useful function is \texttt{summary}, which gives the following 5-number summary

```{r echo=TRUE, message=FALSE}
summary(unsw.satisfaction)
```

## Numerical summaries for one variables

\includegraphics[width=\textwidth]{NumSum1Var.png}

# Graphical Summaries for one variables

## Graphical summaries for categorical random variables

\textcolor{magenta}{Bar charts} are used to summarise **categorical** random variables.

```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="75%", fig.align="center"}
barplot(table(tennis.tv),
        names.arg=c("No", "Yes"),
        main="Did you watch the Australian Open Women Tennis Final?",
        xlab="Answer", ylab="Counts",col="darkred")
```

## Graphical summaries for categorical random variables (II)

```{r echo=FALSE, message=FALSE, out.width="75%", fig.align="center"}
barplot(table(tennis.tv),
        names.arg=c("No", "Yes"),
        main="Did you watch the Australian Open Women Tennis Final?",
        xlab="Answer", ylab="Counts",col="darkred")
```

## Graphical summaries for categorical random variables (III)

The previous plots were done in base \texttt{R}, now let's be fancy and use \texttt{ggplot}!

```{r echo=TRUE, message=FALSE, out.width="75%", fig.align="center"}
tennis <- data.frame(answer=c("No", "Yes"), count=as.vector(tbl))
head(tennis)
```

```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="75%", fig.align="center"}
library(ggplot2)
p <- ggplot(data=tennis, aes(x=answer, y=count)) +
            geom_bar(stat="identity", color="blue",fill="steelblue")+
            geom_text(aes(label=count), vjust=1.6, color="white", 
                      size=8.5)
p
```

## Graphical summaries for categorical random variables (IV)

```{r echo=FALSE, message=FALSE, out.width="75%", fig.align="center"}
library(ggplot2)
p <- ggplot(data=tennis, aes(x=answer, y=count)) +
            geom_bar(stat="identity", color="blue",fill="steelblue")+
            geom_text(aes(label=count), vjust=1.6, color="white", size=8.5)
p
```

## Graphical summaries for categorical random variables (V)

```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="75%", fig.align="center"}
p + 
  ggtitle("Did you watch the Australian Open Women Tennis Final?") +
  xlab("Answer") + 
  ylab("Count") + 
  theme(
        plot.title = element_text(color="red", size=20, face="bold.italic"),
        axis.text = element_text(size=16),
        axis.title.x = element_text(color="blue", size=20, face="bold"),
        axis.title.y = element_text(color="#993333", size=20, face="bold")
        )
```

## Graphical summaries for categorical random variables (VI)

```{r echo=FALSE, eval=TRUE, message=FALSE, out.width="75%", fig.align="center"}
p + 
  ggtitle("Did you watch the Australian Open Women Tennis Final?") +
  xlab("Answer") + 
  ylab("Count") + 
  theme(
        plot.title = element_text(color="red", size=20, face="bold.italic"),
        axis.text = element_text(size=16),
        axis.title.x = element_text(color="blue", size=20, face="bold"),
        axis.title.y = element_text(color="#993333", size=20, face="bold")
        )
```


## Graphical summaries for quantitative random variables

\textcolor{magenta}{Boxplots} and \textcolor{magenta}{histograms} are used to summarise **quantitative** random variables.

```{r echo=FALSE, eval=TRUE, message=FALSE, out.width="65%", fig.align="center"}
sat <- data.frame(satisfaction = unsw.satisfaction)
p2 <- ggplot(data=sat, aes(x="", y=satisfaction)) +
             geom_boxplot(fill = "white", colour = "#3366FF",
                          outlier.colour = "red", outlier.shape = 1) +
             ylab("Score") + 
             xlab("") + 
             theme_bw()
p2
```

## Graphical summaries for quantitative random variables (II)

```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="65%", fig.align="center"}
sat <- data.frame(satisfaction = unsw.satisfaction)
p2 <- ggplot(data=sat, aes(x="", y=satisfaction)) +
             geom_boxplot(fill = "white", colour = "#3366FF",
                          outlier.colour = "red", outlier.shape = 1) +
             ylab("Score") + 
             xlab("") + 
             theme_bw()
p2
```

Note that the length of the whiskers is by default 1.5 times IQR, the argument \texttt{coef} controls that value.

## Graphical summaries for quantitative random variables (III)

```{r echo=FALSE, eval=TRUE, message=FALSE, out.width="65%", fig.align="center"}
p2 + geom_jitter(width = 0.2) + 
     theme(
        axis.text = element_text(size=16),
        axis.title.y = element_text(color="#993333", size=20, face="bold")
     )
```

## Graphical summaries for quantitative random variables (IV)

```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="65%", fig.align="center"}
p2 + geom_jitter(width = 0.2) + 
     theme(
        axis.text = element_text(size=16),
        axis.title.y = element_text(color="#993333", size=20, face="bold")
     )
```

## Graphical summaries for quantitative random variables (V)


```{r echo=FALSE, eval=TRUE, message=FALSE, out.width="65%", fig.align="center",warning=FALSE}
p3 <- ggplot(data=sat, aes(satisfaction)) +
             geom_histogram(fill = "#69b3a2", colour = "purple",
                            bins=10, linewidth=2) +
             ylab("Score") + 
             xlab("") + 
             theme_classic() +
             theme(
                axis.text = element_text(size=16),
                axis.title.y = element_text(color="magenta", size=20, face="bold")
     )
p3
```

## Graphical summaries for quantitative random variables (VI)


```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="65%", fig.align="center"}
p3 <- ggplot(data=sat, aes(satisfaction)) +
             geom_histogram(fill = "#69b3a2", colour = "purple",
                            bins=10, size=2) +
             ylab("Score") + 
             xlab("") + 
             theme_classic() +
             theme(
                axis.text = element_text(size=16),
                axis.title.y = element_text(color="magenta", size=20, face="bold")
     )
p3
```
        
## Graphical Summaries for one variables

\begin{center}
\includegraphics[width=\textwidth]{GraphSum1Var.png}
\end{center}

# Summaries for two or more random variables

## Numerical summaries of two categorical random variables

In this case we use a **2-way table of frequencies**

```{r echo=TRUE, message=FALSE}
table(sex, stress)
```

For fancier table see e.g., \texttt{tabyl()}.

## Numerical summaries of two categorical random variables

Adding \textcolor{blue}{proportions}:

```{r echo=TRUE, message=FALSE}
tbl2 <- table(sex, stress)
round(prop.table(tbl2, margin =2),3) # for column
round(prop.table(tbl2, margin =1),3) # for row
```

For fancier table see e.g., \texttt{tabyl()}.

## Numerical summaries of one categorical and one quantitative random variable

Here we compute a \textcolor{blue}{5-number summary for each group/category}.

```{r echo=TRUE, message=FALSE}
summary(hair.cost[sex=="Female"])
summary(hair.cost[sex=="Male"])
```

## Numerical summaries with at least one categorical variable

\begin{center}
\includegraphics[width=\textwidth]{NumSum2Var.png}
\end{center}

## Graphical summaries of two categorical random variables

When we have two categorical variables, we use a **\textcolor{blue}{clustered bar chart}**

```{r echo=FALSE, eval=TRUE, message=FALSE, out.width="65%", fig.align="center"}
SS <- data.frame(stress=rep(colnames(tbl2), each=2), 
                 sex = c(rep(rownames(tbl2), 5)),
                 count=as.vector(tbl2))
p4 <- ggplot(data=SS, aes(x=stress, y=count, fill=sex)) +
             geom_bar(stat="identity",
                      position="dodge") +
             ggtitle("Are you stressed?") +
             ylab("Count") + 
             xlab("Stress") + 
             theme_classic() +
             theme(
                axis.text = element_text(size=16),
                axis.title = element_text(color="magenta", size=20)
             )
p4
```

## Graphical summaries of two categorical random variables (II)

```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="65%", fig.align="center"}
SS <- data.frame(stress=rep(colnames(tbl2), each=2), 
                 sex = c(rep(rownames(tbl2), 5)),
                 count=as.vector(tbl2))
p4 <- ggplot(data=SS, aes(x=stress, y=count, fill=sex)) +
             geom_bar(stat="identity",
                      position="dodge") +
             ggtitle("Are you stressed?") +
             ylab("Count") + 
             xlab("Stress") + 
             theme_classic() +
             theme(
                axis.text = element_text(size=16),
                axis.title = element_text(color="magenta", size=20)
             )
p4
```

## Graphical summaries of one categorical and one quantitative random variable

In that case, we use **\textcolor{blue}{comparative boxplots}**

```{r echo=FALSE, eval=TRUE, message=FALSE, out.width="65%", fig.align="center"}
SH <- data.frame(sex=sex, hair.cost=hair.cost)

p5 <- ggplot(data=SH, aes(x=sex, y=hair.cost)) +
             geom_boxplot() +
             ggtitle("How much do you spend on a hair cut?") +
             ylab("Amount($)") + 
             xlab("Sex") + 
             theme_classic() +
             theme(
                axis.text = element_text(size=16),
                axis.title = element_text(color="magenta", size=20)
             )
p5
```

## Graphical summaries of one categorical and one quantitative random variable (II)

```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="65%", fig.align="center"}
SH <- data.frame(sex=sex, hair.cost=hair.cost)

p5 <- ggplot(data=SH, aes(x=sex, y=hair.cost)) +
             geom_boxplot() +
             ggtitle("How much do you spend on a hair cut?") +
             ylab("Amount($)") + 
             xlab("Sex") + 
             theme_classic() +
             theme(
                axis.text = element_text(size=16),
                axis.title = element_text(color="magenta", size=20)
             )
p5
```

## Graphical summaries of one categorical and one quantitative random variable (III)

```{r echo=FALSE, eval=TRUE, message=FALSE, out.width="65%", fig.align="center"}
p5 <- ggplot(data=SH[-which.max(hair.cost),], aes(x=sex, y=hair.cost, fill=sex)) +
             geom_boxplot() +
             ggtitle("How much do you spend on a hair cut?") +
             ylab("Amount($)") + 
             xlab("Sex") + 
             scale_fill_brewer(palette="Dark2") +
             theme_classic() +
             theme(
                axis.text = element_text(size=16),
                axis.title = element_text(color="magenta", size=20)
             )
p5 + stat_summary(fun=mean, geom="point", shape=23, size=4) # adding means
```

## Graphical summaries of one categorical and one quantitative random variable (IV)

```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="65%", fig.align="center"}
p5 <- ggplot(data=SH[-which.max(hair.cost),], aes(x=sex, y=hair.cost, fill=sex)) +
             geom_boxplot() +
             ggtitle("How much do you spend on a hair cut?") +
             ylab("Amount($)") + 
             xlab("Sex") + 
             scale_fill_brewer(palette="Dark2") +
             theme_classic() +
             theme(
                axis.text = element_text(size=16),
                axis.title = element_text(color="magenta", size=20)
             )
p5 + stat_summary(fun=mean, geom="point", shape=23, size=4) # adding means
```

## Graphical summaries with at least one categorical variable

\begin{center}
\includegraphics[width=\textwidth]{GraphSum2Var.png}
\end{center}

## Graphical summaries for two quantitative random variables

The easiest way to display **two quantitative random variables** is via a **\textcolor{blue} {scatterplot}**.

```{r echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE, out.width="65%", fig.align="center"}
AH <- data.frame(age=age, hours=hours.sleep)

p6 <- ggplot(data=AH, aes(x=age, y=hours.sleep)) +
             ggtitle("Hours slept as function of age") +
             ylab("Hours slept") + 
             xlab("Age") + 
             theme(
                axis.text = element_text(size=16),
                axis.title = element_text(color="magenta", size=20)
             )
p6 + geom_point(shape = 21, colour = "pink", fill = "black", size = 3, stroke = 3)
```

## Graphical summaries for two quantitative random variables (II)

```{r echo=TRUE, eval=FALSE, message=FALSE, out.width="65%", fig.align="center"}
AH <- data.frame(age=age, hours=hours.sleep)

p6 <- ggplot(data=AH, aes(x=age, y=hours.sleep)) +
             ggtitle("Hours slept as function of age") +
             ylab("Hours slept") + 
             xlab("Age") + 
             theme(
                axis.text = element_text(size=16),
                axis.title = element_text(color="magenta", size=20)
             )
p6 + geom_point(shape = 21, colour = "pink", fill = "black", size = 3, stroke = 3)
```

## Graphical summaries for two quantitative random variables (III)

The easiest way to display **two quantitative random variables** is via a **\textcolor{blue} {scatterplot}**.

```{r echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE, out.width="65%", fig.align="center"}
AH$sex <- sex

p6 + geom_jitter(aes(shape=factor(sex), colour = factor(sex), size=2)) +
     scale_x_continuous(limits = c(18, 45)) +
     scale_y_continuous(limits = c(1, 12)) +
     scale_colour_discrete("Sex") +
     guides(size = "none", shape = "none") +
     theme(legend.text = element_text(size=16))
```

## Graphical summaries for two quantitative random variables (IV)


```{r echo=TRUE, eval=FALSE, message=FALSE, warning=FALSE, out.width="65%", fig.align="center"}
AH$sex <- sex

p6 + geom_jitter(aes(shape=factor(sex), colour = factor(sex), size=2)) +
     scale_x_continuous(limits = c(18, 45)) +
     scale_y_continuous(limits = c(1, 12)) +
     scale_colour_discrete("Sex") +
     guides(size = "none", shape = "none") +
     theme(legend.text = element_text(size=16))
```

## Graphical summaries for two quantitative random variables

\begin{center}
\includegraphics[width=\textwidth]{GraphSum2QVar.png}
\end{center}

## Numerical summaries for two quantitative random variables

\textcolor{magenta}{Correlation} is a special form of dependence (association) **between two quantitative variables**. The correlation coefficient is a number that measures how two quantities are associated. More specifically, it measures both the \textcolor{blue}{strength} and the \textcolor{blue}{direction} of the \textcolor{magenta}{linear statistical relationship} between two quantitative variables.

We denote the (Pearson) Coefficient of correlation by $r$ and for any data set
$$ -1 \leq r \leq 1.$$
It is interpreted as follows:
\begin{itemize}
\item $r$ close to 1 $\Leftrightarrow$ strong \textcolor{magenta}{positive} linear relationship.
\item $r$ close to -1 $\Leftrightarrow$ strong \textcolor{magenta}{negative} linear relationship.
\item $r$ close to 0 $\Leftrightarrow$ weak or non-existent linear relationship.
\end{itemize}

## Numerical summaries for two quantitative random variables (II)

\begin{example}
\begin{center}
\includegraphics[width=0.45\textwidth]{CorPos.png}
\includegraphics[width=0.45\textwidth]{CorNeg.png}
\end{center}
\end{example}

## Numerical summaries for two quantitative random variables (III)

Let's have some fun and play a [``guess the correlation game``](https://www.geogebra.org/m/KE6JfuF9)

In our example, we obtain the correlation using the \texttt{cor()} function. 

First let's have a look at the \texttt{AH} \texttt{data.frame} that we created earlier:

```{r echo=TRUE, message=FALSE}
head(AH[,1:2])
```

## Numerical summaries for two quantitative random variables (III)

And now let's display the correlation:

```{r echo=TRUE, message=FALSE}
cor(AH[,1:2]) # Produces NA!!!
cor(na.omit(AH)[,1:2])
```

## Numerical summaries for two quantitative random variables

\begin{center}
\includegraphics[width=\textwidth]{NumSum2QVar.png}
\end{center}




